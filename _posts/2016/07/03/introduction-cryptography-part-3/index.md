---
Introduction to Cryptography, Part 3
---
<article class="post-listing post-14707 post type-post status-publish format-standard has-post-thumbnail hentry category-deepdot-news tag-cryptography tag-introduction tag-part">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/64bytes/" title="">64Bytes </a></span>
    <span>July 3, 2016</span>
    
    <span><a href="https://www.deepdotweb.com/2016/07/03/introduction-cryptography-part-3/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>In part two we went over the differences between block / stream ciphers and their modes of operation. We also discussed modular arithmetic and the basics of the data encryption standard (DES). This part is going to go over a basic introduction of elliptic curve crypto systems and the OpenSSL cryptography library. To start, let’s go over what elliptic curves are (this is just a tl;dr version; elliptic curve crypto is too complicated to go over in just a single blog post). While Wolfram Mathworld gives a complete definition of elliptic curves <a href="http://mathworld.wolfram.com/EllipticCurve.html"> here</a>, we are going to define elliptic curves with this equation: <em>y<sup>2</sup>= x<sup>3</sup>+ax+b mod p </em>where 4a<sup>3</sup>+27b<sup>2 </sup>? <em>0 mod p</em> (if you do not understand what <em>mod p</em> means, read the previous part in this series). This is called the <em>Weierstrass </em><em>normal form</em> for elliptic curves. The values <em>a </em>and <em>b </em>determine the shape of the curve.</p>
    <p>Why are elliptic curves so important to cryptography? One of the most important pieces of elliptic curves in relation to crypto is the discrete logarithm problem. The discrete logarithm is sometimes known as a “one-way function”. This means that given a function <em>f(x)</em>, but given <em>y </em>it is not possible to find x with <em>y=f(x)</em>. There is no known efficient discrete logarithm solving problem, beyond the generic algorithms that work on every group. Because of this, we get a secure system as soon as <em>p </em>approaches 160 bits in length. In addition to better security, we get better speed. Unlike RSA, elliptic curves are easy to compute on embedded devices such as smart cards.</p>
    <p>There are two popular crypto algorithms that use ECC: ECDSA (elliptic curve digital signature algorithm), and ECDH (elliptic curve diffie-hellman). While all of them sound the same, they are actually different from one another. ECDH is the elliptic curve form of the Diffie-Hellman protocol. It is a form of <em>key agreement</em>; both people can establish a secret value by sending their public key to the other person. As the name implies, ECDSA is the elliptic curve version of DSA. In the TLS protocol, ECDSA can be used to authenticate the handshake part of the process (there is a good PDF <a href="https://www.sans.org/reading-room/whitepapers/protocols/ssl-tls-beginners-guide-1029">here</a> on TLS and SSL if you are not sure what it is).</p>
    <p>We have now gone over enough material to start applying this information, and learn the OpenSSL library. OpenSSL is an open-source crypto suite that can be used for a large variety of tasks such as Public Key Infrastructure (PKI), and HTTPS. While OpenSSL includes an SDK for developers, writing code is out of scope for this tutorial and we will only be covering the command line utility. We are also going to be using Windows 7 for this tutorial.</p>
    <p>As stated by the <a href="https://www.openssl.org/community/binaries.html">OpenSSL website</a>, OpenSSL does not distribute any binaries. To run OpenSSL on Windows, you have to compile the source code yourself or download a third party engine. In this tutorial, we are not going to compile the source code and only use precompiled binaries. Before we download the binaries, we are first going to have to install the VC++ 2008 runtime redistributable from Microsoft. Go ahead and download that from here: <a href="https://www.microsoft.com/en-us/download/details.aspx?id=29">https://www.microsoft.com/en-us/download/details.aspx?id=29</a>. The installation for the VC++ runtime is easy; just click next until the wizard is completed.</p>
    <p>After the download for VC++ has been completed, open it and click next until you have completed the installation. To install OpenSSL, first download it from <a href="https://www.openssl.org/community/binaries.html">https://www.openssl.org/community/binaries.html</a>. It is important to note that you need to download the OpenSSL that corresponds to the version of VC++ you downloaded (32 bit or 64 bit). Installing OpenSSL is as easy as installing VC++: just click next until the wizard finishes. Even though OpenSSL has now been installed, we first have to configure the environment variables and create a folder to store the output from OpenSSL. To do this, go to the C:\ drive and create a new folder called Certificates. Afterwards, navigate to the start menu and open up an administrator command prompt. Once that is open, type in the following:</p>
    <p>&#8211; set RANDFILE=C:\Certificates\.rnd</p>
    <p>&#8211; set OPENSSL_CONF=C:\OpenSSL-Win32\bin\openssl.cfg</p>
    <p>OpenSSL is now ready to be started. To start OpenSSL, type in C:\OpenSSL-Win32\bin\openssl.exe. If everything is successful, you will notice that your drive letter has changed from a letter to OpenSSL&gt;. This allows us to type in commands specific to OpenSSL. The first step is to create the 4096-bit long RSA key and call it ca.key (if you wish to add a password to it, you can add the option –des3):</p>
    <p>&#8211; genrsa -out ca.key 4096</p>
    <p>Next, we are going to generate a self-signed CA certificate:</p>
    <p>&#8211; req -new -x509 -days 1826 -key ca.key -out ca.crt</p>
    <p>Let’s go over what the above command means. We specify –x509 because we are creating a new self-signed certificate, and 1826 means that the certificate is valid for five years. Now that we have created the certificate, we are going to create another CA that will actually be used for signing.</p>
    <p>We first generate the key:</p>
    <p>genrsa -out ia.key 4096</p>
    <p>After, we request a certificate for that key we just generated:</p>
    <p>req -new -key ia.key -out ia.csr</p>
    <p>Note that it is important to have the key name be different from the previous key; otherwise you will get an error when you create the pkcs12 file. The next to last step in the process is to generate the request for the subordinate certificate authority. Run this command:</p>
    <p>x509 -req -days 730 -in ia.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out ia.crt</p>
    <p>The final step in creating a certificate is to package the keys and certs in a PKCS12 file:</p>
    <p>&#8211; pkcs12 -export -out ia.p12 -inkey ia.key -in ia.crt -chain -CAfile ca.crt</p>
    <p>That’s it. We can now use the .crt files in Windows. To install it, double-click on the crt file and click “Install Certificate”. I hope that this tutorial has been useful for someone. If you have any questions or comments, please email me at <a href="/cdn-cgi/l/email-protection#20161442595445536053494741494e540e4f5247"><span class="__cf_email__" data-cfemail="0a3c3e68737e6f794a79636d6b63647e2465786d">[email&#160;protected]</span><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></a></p>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/cryptography/" rel="tag">cryptography</a> <a href="https://www.deepdotweb.com/tag/introduction/" rel="tag">introduction</a> <a href="https://www.deepdotweb.com/tag/part/" rel="tag">part</a></span> <span style="display:none" class="updated">2016-07-03</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/64bytes/" title="Posts by 64Bytes" rel="author">64Bytes</a></strong></div>
    </div>
</article>

