---
Tor&#8217;s Biggest Threat &#8211; Correlation Attack
---
<article class="post-listing post-16040 post type-post status-publish format-standard has-post-thumbnail hentry category-deepdot-news tag-attack tag-biggest tag-correlation tag-threat tag-tors">
    <div class="post-inner">
    <p class="post-meta">
    <span>Posted by: <a href="https://www.deepdotweb.com/author/filipjelic/" title="">Filip Jelic </a></span>
    <span>October 25, 2016</span>
    
    <span><a href="https://www.deepdotweb.com/2016/10/25/tors-biggest-threat-correlation-attack/#comments">16 Comments</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>Throughout the years of Tor existence many users lost their anonymity. I&#8217;m going to explain a technique called &#8220;Correlation Attack&#8221; that government agencies used in the past for that purpose. These include exploiting human errors as well as highly sophisticated mathematical methods exploiting software flaws.</p>
    <p>This attack has been around since Tor widespread usage began and it seems like it isn&#8217;t going anywhere in the recent future. An attacker controlling the first and last router in a Tor circuit can use timing and data properties to correlate streams observed at those routers and therefore break Tor’s anonymity.</p>
    <p><img class="wp-image-16041 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-69.png" srcset="https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-69.png 988w, https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-69-300x189.png 300w" sizes="(max-width: 988px) 100vw, 988px"/></p>
    <p>No simple patch can be made that can prevent this method because it&#8217;s not exploiting any bug, but rather uses math (probability and statistics) and attacks the logic of Tor network. With that said, there are ways to made this task much more difficult, but they are usually rejected to preserve low latency.</p>
    <p>Some attacks are not even against software, but against users. For example, if dark market admin shared some information about himself such as state, age and/or past criminal activities, it becomes feasible for government agencies to monitor all possible suspects&#8217; internet activity and try to see which one connects to the Tor network at the same time admin comes online.</p>
    <p>Previous example was easy, let&#8217;s analyze a case where targets are smarter and disclose zero information about themselves. The idea is to control a sizeable portion of Tor relays and hopefully, as many guards (1<sup>st</sup> relay that knows your IP address) and exit relays (those that connect to server).</p>
    <p>It&#8217;s already clear that this attack needs good sponsorship and is mostly done by government agencies. Reason behind this is that Tor counts over 7000 relays and over 2 million daily users.</p>
    <p>Since Tor employs <a href="https://www.torproject.org/getinvolved/volunteer.html.en">volunteer resource model</a>, anyone is encouraged to start any number of relays to help Tor network. One that controls a sizeable portion of relays has a chance of &#8220;serving&#8221; as guard and end relay for the same user. It&#8217;s only a matter of time when you will start using compromised circuit.</p>
    <p><img class="wp-image-16042 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-70.png" srcset="https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-70.png 992w, https://www.deepdotweb.com/wp-content/uploads/2016/10/word-image-70-300x162.png 300w" sizes="(max-width: 992px) 100vw, 992px"/></p>
    <p>Attacker uses automatic packet analysis on both relays to calculate a correlation coefficient. The most useful variables are timing, packet size and frequency. Although this information gives the attacker pretty good idea which website you are visiting, because of huge size of Tor network there are many false positives.</p>
    <p>Exact percentage of these conclusion greatly vary on what kind of traffic you are making. For example, the easiest target is the one that is downloading some files because there are many sizeable packets to compare. One that is simply browsing a website is doing the same as thousands of other users and a chance for false positives increases.</p>
    <p>According to this <a href="https://cryptome.org/2013/08/tor-users-routed.pdf">paper</a>, 80% of users can de deanonymized in the period of six months by realistic adversaries. This is no proof on court because of possible false positives (ranges from 5-10% depending on the correlation algorithm), but provides enough suspicion to start further monitoring.</p>
    <p>It&#8217;s very likely that Carnegie Mellon University attack on Tor network was indeed correlation attack. The information about Tor users was then sold to FBI for <a href="https://www.deepdotweb.com/2015/11/17/university-accused-of-accepting-1-million-for-exposing-tor-users-fbi-denies/">$1 million</a>. At the time (early 2014), Tor relays could easily confirm their suspicion by adding an arbitrary value to the packet and check for it on the other end to reach the level of certainty. This was quickly patched, but correlation attack is still not prevented.</p>
    <p>This attack was pitfall for <a href="https://www.deepdotweb.com/2015/11/15/university-helped-fbi-in-silk-road-2-and-child-porn-busts/">many websites</a> and their users including Silk Road 2.0 and 2 child porn sites.</p>
    <p>Good thing is that Tor contributors are well aware of this attack. The Tor Project is already working on <a href="https://gitweb.torproject.org/torspec.git/tree/proposals/254-padding-negotiation.txt">techniques</a> that make website fingerprinting attacks less effective.</p>
    <p>You shouldn&#8217;t be concerned about these attacks if you&#8217;re using a trusted VPN to connect to Tor network because this attack won&#8217;t yield your IP address, but the one belonging to a proxy server. Be aware that all VPNs must obey the laws of the country they reside in and most countries require all ISP (including VPNs) to keep the log of all users activity for a period of time (usually around 2 years) and provide that information if the court issues a warrant. Even if VPN resides in a country that has no such laws, they might be selling your information. Thankfully, deepdotweb offers great advice on choosing the right VPN.</p>
    <p>Before you comment &#8220;VPN + Tor sucks&#8221;, read what Tor developers have to say on <a href="https://trac.torproject.org/projects/tor/wiki/doc/TorPlusVPN">this topic</a>. Using <a href="https://www.deepdotweb.com/vpn-comparison-chart/">VPN</a> has both its benefits and downsides, I recommended using VPN because it saves you from this particular attack.</p>
    <p>My opinion is that the quality of VPN is all that matters. If they log your data, they will only make government agencies wait for a warrant. They&#8217;ll sell it to everyone that offers some money too. On the other hand, no-log VPN can be invaluable.</p>
    <p>P.S. I believe all VPNs keep logs – why wouldn&#8217;t they? You can&#8217;t know it anyway. And I can&#8217;t persuade myself that they would refuse money for my identity either. At least some VPNs don&#8217;t have to give up our identity to law enforcement agencies, which is nice.</p>
    <p><img class="wp-image-16043 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image-.png" alt="Inserting image..." srcset="https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image-.png 400w, https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image--150x150.png 150w, https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image--300x300.png 300w, https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image--55x55.png 55w, https://www.deepdotweb.com/wp-content/uploads/2016/10/inserting-image--50x50.png 50w" sizes="(max-width: 400px) 100vw, 400px"/></p>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/attack/" rel="tag">attack</a> <a href="https://www.deepdotweb.com/tag/biggest/" rel="tag">biggest</a> <a href="https://www.deepdotweb.com/tag/correlation/" rel="tag">correlation</a> <a href="https://www.deepdotweb.com/tag/threat/" rel="tag">threat</a> <a href="https://www.deepdotweb.com/tag/tors/" rel="tag">tors</a></span> <span style="display:none" class="updated">2016-10-25</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/filipjelic/" title="Posts by Filip Jelic" rel="author">Filip Jelic</a></strong></div>
    </div>
</article>

