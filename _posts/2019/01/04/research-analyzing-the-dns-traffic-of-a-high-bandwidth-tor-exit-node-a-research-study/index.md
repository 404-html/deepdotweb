---
Research: Analyzing the DNS traffic of a high bandwidth Tor exit node &#8211; A research study
---
<article class="post-listing post-27961 post type-post status-publish format-standard has-post-thumbnail hentry category-deepdot-news tag-analyzing tag-bandwidth tag-dns tag-exit tag-high tag-node tag-research tag-study tag-tor tag-traffic">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
    <span>January 4, 2019</span>
    
    <span><a href="https://www.deepdotweb.com/2019/01/04/research-analyzing-the-dns-traffic-of-a-high-bandwidth-tor-exit-node-a-research-study/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>Internet usage differs markedly from one country to another when accessed websites are considered, especially in countries where censorship is exercised. People all over the world usually use Tor to communicate anonymously over the internet. The institute of networks and security (INS) hosts an exit node, with high bandwidth (200 MBit/s), on the Tor network for research purposes. <a href="https://link.springer.com/chapter/10.1007/978-3-030-05345-1_3">A recently published research study</a> investigated the DNS traffic of this Tor exit node for anomalies and used the obtained results to identify which websites people are visiting via the Tor network.</p>
    <p>The <a href="https://www.deepdotweb.com/2018/10/24/dynamic-learning-of-tor-network-traffic-using-privacy-preserving-methods/">exit traffic of this high bandwidth Tor exit node</a> provided statistics concerning websites visited, bandwidth, and the target countries based on the IP addresses. The study was then extended to involve the DNS traffic associated with this exit node. Because the <a href="https://www.deepdotweb.com/2017/03/30/tor-browser-fully-anonymous-myth-reality/">Tor system is namely used for anonymization</a>, all DNS requests, along with their associated replies, originated from the Tor exit traffic. This information was obtained via installing a special DNS relay server, linking it to a university DNS server, and setting the configuration of the Tor exit node in order to use this DNS relay server for the purpose of name resolution. Query logs obtained from the DNS relay server will thus include all needed information, including the requested domain name and the response, i.e. the IP address. Moreover, any direct relationships to connections (<a href="https://www.deepdotweb.com/2018/10/10/reconstructing-tor-circuits-using-compartment-adversaries-and-monitoring-of-cross-border-traffic/">Tor circuits</a>) are broken. To maximize the details of data obtained, the values of DNS timeouts, returned by the relay to the exit node, is set to a low level of 1 minute.</p>
    <p>The study presents some interesting information, which we will overview throughout this article.</p>
    <p><strong>Top ranked surface internet websites (NOT visited):</strong></p>
    <p>Surface internet websites belonging to Alexa&#8217;s top 1 million list, which were not accessed via Tor, represent one of the investigations conducted throughout this study. These include websites which are sometimes not accessed during a 1 hour period, websites which are often missing, and websites that are never or very rarely accessed via the study&#8217;s Tor exit node. Only the top 100 websites of the list were checked.</p>
    <p>The first group of websites (almost always visited) included twitch.tv, sina.com.cn, wikia.com, 360.cn, ebay.com, aliexpress.com, weibo.com, livejasmin.com, yahoo.co.jp, linkedin.com, google.co.uk, bongcams.com, alipay.com, netflix.com, baidu.com, pornhub.com, t.co, wikipedia.org, xhamster.com, tumblr.com, reddit.com, and google.fr. These websites were absent between 6.7% of all 1 hour periods (twitch.tv) and almost 0% not occurring in a single hour over a period of five months (the last six websites of the aforementioned list).</p>
    <p>The second group included websites which were absent in 12.8% to 29.8% of the traffic of the studied Tor exit node. The group included amazon.co.jp, google.com.br, imdb.com, jd.com, sohu.com, naver.com, and google.co.in.</p>
    <p>The third group included websites which are absent between 100% (never visited) and 53.7% of the traffic of the studied Tor exit node. The group included tmall.com, login.tmall.com, and google.co.jp.</p>
    <p><strong>Country code top-level-domains (TLDs) queried via Tor:</strong></p>
    <p>Evaluation of the domains&#8217; country codes shows several anomalies. As shown via the chart in figure (1), after exclusion of all generic TLDs, the TLD distribution of the queried domain names showed extreme distribution.</p>
    <p><img class="wp-image-27965" src="https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-1-png.png" alt="Tor exit node (1).PNG" srcset="https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-1-png.png 729w, https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-1-png-300x155.png 300w" sizes="(max-width: 729px) 100vw, 729px" /></p>
    <p><strong>Figure (1): Domain name queries in comparison with registered domain names</strong></p>
    <p>29% of all country code TLD queries are for domain names under .ru, while 12.5% are for domain names under .de. The .fr country code represented 4.27% of the queries, and .nl represented 4.04%. Collectively, each of the top 25 country codes represented over 1%, and all together they accounted for 86.9% of all domain name queries. Under the .ru country code there are 4,976,168 registered domain names, while under the .de country code, there are 14,572,679 domains (around three times as many). As such, in comparison, the .ru country code is overpresented to .de by a factor of 6.8. A more striking result can be obtained with the .su country code (the former Soviet Union which still exists as a TLD and is mainly used in Russia), which was associated with 4.7 times as many domain name queries during the period of 5 months than .ru. Another spike exists for Ukraine&#8217;s country code, .ua, where online censorship is exercised by the state. The peaks associated with .tv and .io can be explained â€“ these domain names&#8217; codes are registered for the purpose of the name itself, unlike other TLD country codes.</p>
    <p>Consequently, we can conclude for which country code TLDs it is more important for users to access anonymously. Russian websites are almost always visited anonymously, while no one cares whether or not German websites identify who their visitors are. Nevertheless, China represents a different example. China has very strict rules regarding internet access, so Tor represents a pivotal tool to users there. China has an enormous number of registered domains, but comparatively with a relatively small number of queries. This can be explained by the fact that domains registered under the Chinese country code are hosted within China, which means that their content is mostly under political control and the name of the website owner is strictly verified. As such, accessing these websites in an anonymous manner is useless, as undesirable or critical website content can never be expected. For Chinese users, the importance of Tor lies in accessing foreign websites. On the other hand, Russians and Ukrainians have less difficulties in accessing foreign online content, yet they may want to maintain their anonymity against their states.</p>
    <p>Results are very similar when the amount of traffic is considered. Figure (2) shows the traffic volume in Bytes transferred to different countries on the basis of the IP address location.</p>
    <p><img class="wp-image-27966" src="https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-2-png.png" alt="Tor exit node (2).PNG" srcset="https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-2-png.png 747w, https://www.deepdotweb.com/wp-content/uploads/2019/01/tor-exit-node-2-png-300x155.png 300w" sizes="(max-width: 747px) 100vw, 747px" /></p>
    <p><strong>Figure (2): Comparing DNS queries to traffic associated with different countries</strong></p>
    <p>We can note that the exceptions are associated with .fr, .cn, .nl, .ro, and .at. The big traffic volume associated with Austria can be explained via the geo-location of the exit node, particularly large-scale internet traffic, such as video, will be routed to close servers. France, Romania, and the Netherlands are comparable as they have many hosting centers for TLDs from numerous parts of the world. This would leave China as the exception, as some popular websites targeted at other world countries can be physically hosted in China. This can be explained by the fact that Chinese users are often forced to use Tor, even if its services are suboptimal (large files, remote exit node, etc.).</p>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/analyzing/" rel="tag">analyzing</a> <a href="https://www.deepdotweb.com/tag/bandwidth/" rel="tag">bandwidth</a> <a href="https://www.deepdotweb.com/tag/dns/" rel="tag">dns</a> <a href="https://www.deepdotweb.com/tag/exit/" rel="tag">exit</a> <a href="https://www.deepdotweb.com/tag/high/" rel="tag">high</a> <a href="https://www.deepdotweb.com/tag/node/" rel="tag">node</a> <a href="https://www.deepdotweb.com/tag/research/" rel="tag">research</a> <a href="https://www.deepdotweb.com/tag/study/" rel="tag">study</a> <a href="https://www.deepdotweb.com/tag/tor/" rel="tag">tor</a> <a href="https://www.deepdotweb.com/tag/traffic/" rel="tag">traffic</a></span> <span style="display:none" class="updated">2019-01-04</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
    </div>
</article>

