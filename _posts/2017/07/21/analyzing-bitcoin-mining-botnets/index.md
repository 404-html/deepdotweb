---
Analyzing Bitcoin Mining Botnets (Minerbots) &#8211; How Can We Shield Our Systems Against Minerbots?
---
<article class="post-listing post-21476 post type-post status-publish format-standard has-post-thumbnail hentry  tag-analyzing tag-bitcoin tag-botnets tag-minerbots tag-mining tag-shield tag-systems">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
    <span>July 21, 2017</span>
    
    <span><a href="https://www.deepdotweb.com/2017/07/21/analyzing-bitcoin-mining-botnets/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    
    <p>Botnets have recently become one of the most serious forms of malicious tools used by cybercriminals to launch a myriad of attacks not only on individuals, but also on servers belonging to large organizations. Botnets can be used to perform a variety of malicious attacks including DDoS attacks, email spamming, phishing of private data, identity theft, bitcoin mining and others. Most recently, cybercriminals have been using botnets to exploit the computational power of victim&#8217;s machines in pooled bitcoin mining. Such forms of botnets are referred to as &#8220;miner botnets&#8221;.</p>
    <p><a href="http://search.proquest.com/openview/ace850434f42b9975f5867d74e4bdace/1?pq-origsite=gscholar&amp;cbl=136216">A recently published paper</a> discussed how miner botnets are used to mine bitcoin via compromised machines. The authors of the paper also examined the network flow of two miner botnets known as &#8220;ZeroAccess&#8221; and &#8220;Neris&#8221;, providing a DNS relationship that aids in identification of the botnets. They also proposed a security algorithm and framework that can protect an OS from being compromised by a miner botnet. Throughout this article, we will review this study and its interesting results.</p>
    <p><img class="wp-image-21486" src="/imgs/2017/07/word-image-24.png" srcset="/imgs/2017/07/word-image-24.png 730w, /imgs/2017/07/word-image-24-300x276.png 300w" sizes="(max-width: 730px) 100vw, 730px" /></p>
    <p><strong>How Miner Botnets Work:</strong></p>
    <p>A botnet represents a network of compromised machines that are controlled by the botmaster via a central Command &amp; Control (C&amp;C) server. The botmaster communicates with his/her network of bots, i.e. infected machines, via the C&amp;C server(s). These central C&amp;C servers represent a major vulnerability of the framework of a botnet, as once the C&amp;C server is taken down, the botnet is successfully defeated. To mitigate this issue, <a href="https://www.deepdotweb.com/2017/06/16/overview-peer-peer-p2p-botnets/">botmasters started utilizing a more complicated peer-to-peer (P2P) network structure</a> for their C&amp;C servers. Due to the distributed nature of such P2P networks, disruption of the botnet becomes harder to accomplish.</p>
    <p>Nowadays, botmasters use the Tor network to render their C&amp;C servers anonymous and almost impossible to trace. Miner botnets mostly rely on C&amp;C servers which are hosted on the Tor network in the form of hidden services. Via pooled bitcoin mining, botmasters can covertly exploit the computational power of victims&#8217; machines to mine bitcoins. The miner bot accomplishes this via silently installing mining software, e.g. CGMiner, on the compromised machines. Once installed, it runs quiescently in the background of the OS of the infected machine and uses the processing power of the CPU and GPU to mine bitcoin. The mining software is setup to join a bitcoin mining pool; a public pool, or a dark pool. On a public mining pool, there is a considerable chance that the botnet will be detected and banned, while on a dark pool, the chance of detection is much lower, yet the botmaster will have to pay for the fees of maintenance of the dark pool. Once the mining pool has been joined, all bots will start mining bitcoin and will save the mined coins to the botmaster&#8217;s wallet.</p>
    <p><strong>Methods Used For Minerbot Analysis:</strong></p>
    <p>To analyze miner botnets, the researchers utilized a five step process:</p>
    <p>1. Setting up a virtual environment: This involved creation of a virtual machine, or a virtual operating system OS, using a program such as VMware, in order to be able to capture the malware without inducing any damage to the true OS.</p>
    <p>2. Executing the malware: This involved executing the malware on the virtual machine and capturing its activity using Wireshark and the Advanced Task Manager.</p>
    <p>3. Data analysis: This involved analyzing the data captured in the previous step for anomalous traffic, packets sent to suspicious IP addresses,&#8230;etc.</p>
    <p>4. Results: Results were obtained via data analysis. They were posted as results of the research study.</p>
    <p>5. Conclusion: The conclusion of the study was based on all the information extracted from all the above steps.</p>
    <p>The study involved analysis of the Pcap files of two minerbots; ZeroAccess and Neris. It was found that botmasters of these miner bots use multiple C&amp;C servers whose IP addresses are routed to the bot in the form of a reply to its DNS query. As such, when a DNS reply includes &gt;7-8 answers, i.e. &gt;7-8 IP addresses, in the answer field, this mostly represents a DNS query of a botnet that has been generated by an infected machine (bot) as shown on the below figure of a Neris miner bot.</p>
    <p><img class="wp-image-21487" src="/imgs/2017/07/word-image-25.png" srcset="/imgs/2017/07/word-image-25.png 465w, /imgs/2017/07/word-image-25-300x258.png 300w" sizes="(max-width: 465px) 100vw, 465px" /></p>
    <p><strong>Proposed Idea For Protection Against Miner Bots:</strong></p>
    <p>The researchers found out there are similarities between the packets requested by most botnet infected systems. For example, DNS replies to a DNS query of a miner bot included more IP addresses than the threshold limit (7-8 addresses) in the answer field. They proposed a framework which is presented in the below figure to prevent our systems from being infected by botnets, especially miner bots.</p>
    <p><img class="wp-image-21488" src="/imgs/2017/07/word-image-26.png" srcset="/imgs/2017/07/word-image-26.png 413w, /imgs/2017/07/word-image-26-150x150.png 150w, /imgs/2017/07/word-image-26-300x300.png 300w, /imgs/2017/07/word-image-26-55x55.png 55w, /imgs/2017/07/word-image-26-50x50.png 50w" sizes="(max-width: 413px) 100vw, 413px" /></p>
    <p>The framework begins by capturing packets from the TCP/IP stack. This is followed by applying white paper and black paper filtering, as white paper filtering will include all genuine IPs, while black paper filtering will include IPs of already known cyber attackers and malware. The framework utilizes the DNS threshold algorithm, which acts to quarantine packets whose DNS replies include more answers in the answer field than the predefined threshold (7-8 answers, or IP addresses). Eliminating such packets will prevent the miner bot running on the machine from interacting with the C&amp;C server; thus, prevent it from exploiting the machine&#8217;s processing power in bitcoin mining.</p>
    </div>
    <a href="https://www.deepdotweb.com/tag/analyzing/" rel="tag">analyzing</a> <a href="https://www.deepdotweb.com/tag/bitcoin/" rel="tag">bitcoin</a> <a href="https://www.deepdotweb.com/tag/botnets/" rel="tag">botnets</a> <a href="https://www.deepdotweb.com/tag/minerbots/" rel="tag">minerbots</a> <a href="https://www.deepdotweb.com/tag/mining/" rel="tag">mining</a> <a href="https://www.deepdotweb.com/tag/shield/" rel="tag">shield</a> <a href="https://www.deepdotweb.com/tag/systems/" rel="tag">systems</a></span> <span style="display:none" class="updated">2017-07-21</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
    </div>
</article>

