---
The Bayesian Method For Deanonymising A Large Percentage of Bitcoin Transactions"
---
<article class="post-listing post-17288 post type-post status-publish format-standard has-post-thumbnail hentry  tag-bayesian tag-bitcoin tag-deanonymising tag-large tag-method tag-percentage tag-transactions">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
    <span>January 3, 2017</span>
    <span>in <a href="https://www.deepdotweb.com/category/deepdot-news/" rel="category tag">Featured</a>, <a href="https://www.deepdotweb.com/category/news-updates/" rel="category tag">News Updates</a></span>
    <span><a href="https://www.deepdotweb.com/2017/01/03/bayesian-method-deanonymising-large-percentage-bitcoin-transactions/#comments">3 Comments</a></span>
    </p>
    <div class="clear"></div>
    
    <p>Although bitcoin is famous for its anonymity level, it is agreed that it is not completely anonymous as there are multiple ways for tracking the sender of bitcoin transactions in most cases. We will discuss the Bayesian method for identification of bitcoin addresses throughout this article.</p>
    <p><img class="wp-image-17292 aligncenter" src="/imgs/2016/12/btc-anonymous-jpg.jpeg" alt="BTC anonymous.jpg" srcset="/imgs/2016/12/btc-anonymous-jpg.jpeg 450w, /imgs/2016/12/btc-anonymous-jpg-300x226.jpeg 300w" sizes="(max-width: 450px) 100vw, 450px" /></p>
    <p><a href="https://arxiv.org/pdf/1612.06747v3.pdf">The Bayesian method for identification of bitcoin addresses</a> can be broken down into 3 main steps:</p>
    <p>1- Identification of the IP addresses linked to transactions in question</p>
    <p>2- Categorization of bitcoin addresses</p>
    <p>3- Assigning bitcoin addresses to users.</p>
    <p>First, messages propagating across the bitcoin network are recorded and observed via special monitoring clients so that the greatest possible part of the network could be covered. These clients get information from the senders of transactions before being relayed onto the first time segment. After some analysis, more attention is directed towards the monitoring clients that are likely to be the originator of the transaction.</p>
    <p>Then, analysis of the blockchain is done to categorize bitcoin addresses belonging to the same user. This is facilitated by the innate properties of the blockchain which enable detection of the balances of various bitcoin addresses.</p>
    <p>Finally, by obtaining multiple transactions originating from the same bitcoin address and categorizing bitcoin addresses according to users will enable us to combine data from multiple transactions to pinpoint users with relative accuracy. The monitoring clients are grouped according to geolocations via IP addresses, which permits pinpointing of bitcoin addresses and prediction of the geographical distribution and bitcoin flow across the world.</p>
    <p><strong>Step 1: Setting Probabilities:</strong></p>
    <p>Let us propose that a bitcoin transaction has been detected and recorded by the monitoring client. Even when a monitoring client establishes a connection to the originating address, this doesn&#8217;t mean that the client will intercept the message first, as the message is occasionally relayed faster via a mediator client.</p>
    <p>If the originator address has less than 20 active connections, it informs all connected clients within 2 seconds or less that the monitoring client has first received the message. If we assume that there are around 50000 monitoring clients, around 92% of them will have no more than 20 connections. After the transaction is executed, each bitcoin client within the first time segment could be the bitcoin wallet address originating the transaction or another client relaying it. On the other hand, the originator address can be part of the rest of the bitcoin network, if it doesn&#8217;t get connected to the monitoring client.</p>
    <p>To calculate the probability, we will use the following notations: C denoting that the monitoring clients has connected successfully to the originator of the transaction, O denotes that the originator has relayed the message within the context of the first time segment to the monitoring client and F denotes that a random client off the first time segment is the real originator of transaction.</p>
    <p>P (C) = |C| / |A|</p>
    <p>If the monitoring client successfully establishes a connection to the originator, it will inform the monitoring client within the context of the first time segment. Accordingly, all first time segment clients have equal probabilities of being the originator.</p>
    <p>P (O|C) = 1 P(F|C) = 1 / |F|</p>
    <p>If we then apply the law of total probability, we can get the following formula:</p>
    <p><img class="wp-image-17293" src="/imgs/2016/12/formula-bayesian-png.png" alt="formula Bayesian.PNG" srcset="/imgs/2016/12/formula-bayesian-png.png 398w, /imgs/2016/12/formula-bayesian-png-300x43.png 300w" sizes="(max-width: 398px) 100vw, 398px" /></p>
    <p>The above formula provides the probability of all clients belonging to the first time segment. Connected clients that aren&#8217;t part of the first time segment have a probability of zero. The remaining active clients have a probability of 1 / |A|.</p>
    <p><strong>Step 2: Categorizing Bitcoin transactions that belong to the same user:</strong></p>
    <p>The next step is to categorize bitcoin addresses according to the users that own them. In such a way, every transaction can be linked to its sender via analyzing the originating address of the transaction. It is well known that bitcoin addresses that appear on the input side of a given transaction belong to the same user. The below figure shows how bitcoin addressed are grouped. Transactions on the left side of the diagram are linked to their originating addresses, while the right side shows how bitcoin addresses are grouped.</p>
    <p><img class="wp-image-17294 aligncenter" src="/imgs/2016/12/addresses-png.png" alt="addresses.PNG" srcset="/imgs/2016/12/addresses-png.png 638w, /imgs/2016/12/addresses-png-300x164.png 300w" sizes="(max-width: 638px) 100vw, 638px" /></p>
    <p><strong>Step 3: Correlating probabilities &#8211; Naive Bayes Classification:</strong></p>
    <p>Message propagation can be used to determine if clients are the originators of bitcoin transactions. IP addresses collected will be collectively divided into two groups: &#8220;originator&#8221; and &#8220;non-originator&#8221; IPs. In most cases, one IP can be linked to the originator address, however, as some users use more than one IP to create bitcoin transactions, more than one IP address can be linked to the originating address when final results are obtained. By applying the naive Bayes classifier, the probability of a given IP address belonging to the C<sub>o </sub>originator class can be calculated by the following formula.</p>
    <p><img class="wp-image-17295 aligncenter" src="/imgs/2016/12/formula-2-png.png" alt="formula 2.PNG" srcset="/imgs/2016/12/formula-2-png.png 618w, /imgs/2016/12/formula-2-png-300x39.png 300w" sizes="(max-width: 618px) 100vw, 618px" /></p>
    <p>Bitcoin transactions are not completely anonymous, yet there are <a href="https://www.deepdotweb.com/2014/03/02/how-to-use-tor-to-buy-things-anonymously-from-agora-with-bitcoin/">multiple ways that can help you cover your tracks when using bitcoin</a> and also you can <a href="https://www.deepdotweb.com/jolly-rogers-security-guide-for-beginners/obtaining-sending-and-receiving-bitcoins-anonymously/">receive bitcoin almost anonymously</a> by using special techniques and precautions. The Bayesian approach has proven efficacy in deanonymising bitcoin transactions using simple techniques.</p>
    </div>
    <a href="https://www.deepdotweb.com/tag/bayesian/" rel="tag">bayesian</a> <a href="https://www.deepdotweb.com/tag/bitcoin/" rel="tag">bitcoin</a> <a href="https://www.deepdotweb.com/tag/deanonymising/" rel="tag">deanonymising</a> <a href="https://www.deepdotweb.com/tag/large/" rel="tag">large</a> <a href="https://www.deepdotweb.com/tag/method/" rel="tag">method</a> <a href="https://www.deepdotweb.com/tag/percentage/" rel="tag">percentage</a> <a href="https://www.deepdotweb.com/tag/transactions/" rel="tag">transactions</a></span> <span style="display:none" class="updated">2017-01-03</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
    
