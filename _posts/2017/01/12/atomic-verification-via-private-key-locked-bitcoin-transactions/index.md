---
Atomic Verification Via Private Key Locked Bitcoin Transactions"
---
<article class="post-listing post-17451 post type-post status-publish format-standard has-post-thumbnail hentry  tag-atomic tag-bitcoin tag-key tag-locked tag-private tag-transactions tag-verification">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
    <span>January 12, 2017</span>
    
    <span><a href="https://www.deepdotweb.com/2017/01/12/atomic-verification-via-private-key-locked-bitcoin-transactions/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    
    <p>The <a href="https://www.deepdotweb.com/2016/04/27/smart-contracts-will-replace-intermediaries-notaries/">smart contract technology</a> permits the creation of new protocols that can be implemented on top of bitcoin&#8217;s protocol itself. This signals the development of complex scripts, that are far beyond the requirement of a single digital signature. <a href="https://eprint.iacr.org/2016/1184.pdf">A research paper, which has been published a few days ago, introduced a new concept of private key locked bitcoin transactions</a>, which represents an innovative type of transactions that permit atomic verification of a specific private key (which belongs to an asymmetric pair of keys) throughout the process of execution of the script.</p>
    <p><img class="wp-image-17458 aligncenter" src="/imgs/2017/01/bitcoin-locked-transaction-jpg.jpeg" alt="bitcoin locked transaction.jpg" width="639" height="664" srcset="/imgs/2017/01/bitcoin-locked-transaction-jpg.jpeg 1200w, /imgs/2017/01/bitcoin-locked-transaction-jpg-289x300.jpeg 289w, /imgs/2017/01/bitcoin-locked-transaction-jpg-986x1024.jpeg 986w" sizes="(max-width: 639px) 100vw, 639px"/></p>
    <p><strong>What Are Private Key Locked Bitcoin Transactions?</strong></p>
    <p>Although the present hash locked bitcoin transactions permit the usage of a symmetric key to unlock the value of a transaction, or even a private key that belongs to an asymmetric pair of keys, considering that a private key can only be verified using the correspondent public key can inspire the development of a more secure and simple approach.</p>
    <p>Symmetric keys are forms of arbitrary characters, as they are strings of bits. Consequently, the only way to certify the validity of a given symmetric key is to confirm that it successfully decrypts data which was initially encrypted using that same key.</p>
    <p>On the other hand, anyone can check if a private key and a public key match a pair. This can easily be achieved using the <a href="https://www.deepdotweb.com/2016/07/03/introduction-cryptography-part-3/">Elliptic Curve Digital Signature Algorithm ECDSA</a>; you just have to multiply, the integer that represents a given private key, by a base point on the elliptic curve, a predefined system parameter, which would result in a point on the curve that corresponds to the public key. The bitcoin protocol uses a <strong>secp256k1</strong> implementation to formulate ECDSA operations which includes a mathematical function that multiplies a given generator by a specific scalar (<strong>secp256k1_ecmult_gen</strong>). This function is utilized to calculate ECDSA digital signatures.</p>
    <p>By developing novel bitcoin opcodes, a new crypto opcode can be implemented to perform this validation statement <strong>OP_CHECKKEYPAIRVERIFY</strong> which will pop outside the two values of <strong>privKey</strong> and <strong>pubKey</strong>, which correspond to ECDSA&#8217;s private key and public key respectively) and verify that the two keys match a pair. Alternatively, if the two keys match a pair, the opcode will roll back to the stack&#8217;s two operands and the transaction execution process will start.</p>
    <p><strong>OP_CHECKKEYPAIRVERIFY </strong> execution would fail whenever the validation process doesn&#8217;t ensue and so, the stack would remain unchanged. This will guarantee that the opcode can only be implemented in the form of a soft fork via utilizing one of the unused <strong>OP_NOPx</strong> opcode, in a way that closely resembles what has been done previously with <strong>OP_ CHECKLOCKTIMEVERIFY</strong> (<strong>OP NOP2</strong>) and <strong>OP_CHECKSEQUENCEVERIFY</strong> (<strong>OP NOP3</strong>).</p>
    <p>Utilizing this new form of opcode can construct a transaction output in a way that will only be executed, if and only if, the private key and the public key in question match a pair. The following represents a <strong>scriptPubKey </strong> of such transaction output along with the <strong>scriptSig </strong> required to spend it:</p>
    <p><strong>ScriptPubKey: &lt;pubKey&gt; OP_CHECKKEYPAIRVERIFY OP_NIP OP_CHECKSIG </strong></p>
    <p><strong>ScriptSig: &lt;sig&gt; &lt;privKey&gt;</strong></p>
    <p>The script will initially confirm that the private and public keys represent a matching key pair. It is worth mentioning that the stack value will remain unchanged, if the validation process is completed successfully. Accordingly, before confirming the signature validity via <strong>OP_CHECKSIG</strong>, the value of the private key should be taken off the stack, due to the fact that it is not needed throughout the process of signature validation. On the other hand, executing <strong>OP_NIP </strong>will take the private key off the stack. In the end, <strong>OP_CHECKSIG </strong>will start the process of signature validation with the corresponding public key. When the signature is validated successfully, the script will terminate and the funds will be redeemed by the predesigned payment receiver.</p>
    <p>Although utilizing the proposed <strong>OP_CHECKKEYPAIRVERIFY</strong> opcode is seemingly useful in the creation of bitcoin smart contracts, practically speaking, this opcode is nonexistent. <strong>OP_CHECKKEYPAIRVERIFY</strong> can be proposed in the form of a BIP. Meanwhile, the authors of the paper proposed using an existent ECDSA vulnerability to achieve the same goal, which is creating transaction outputs that are reliant on revealing specific private keys to be successfully spent and redeemed. This vulnerability is an innate property of the ECDSA signature scheme, which permits sound implementation of the key verification process.</p>
    </div>
    <a href="https://www.deepdotweb.com/tag/atomic/" rel="tag">atomic</a> <a href="https://www.deepdotweb.com/tag/bitcoin/" rel="tag">bitcoin</a> <a href="https://www.deepdotweb.com/tag/key/" rel="tag">key</a> <a href="https://www.deepdotweb.com/tag/locked/" rel="tag">locked</a> <a href="https://www.deepdotweb.com/tag/private/" rel="tag">private</a> <a href="https://www.deepdotweb.com/tag/transactions/" rel="tag">transactions</a> <a href="https://www.deepdotweb.com/tag/verification/" rel="tag">verification</a></span> <span style="display:none" class="updated">2017-01-12</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
    
