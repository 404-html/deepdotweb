---
New OSX Malware Uses Tor and a MITM Proxy
---
<article class="post-listing post-19848 post type-post status-publish format-standard has-post-thumbnail hentry  tag-malware tag-mitm tag-osx tag-proxy tag-tor">
    <div class="post-inner">
        <span>Posted by: <a href="https://www.deepdotweb.com/author/caliens/" title="">C. Aliens </a></span>
    <span>May 13, 2017</span>
    <span>in <a href="https://www.deepdotweb.com/category/deepdot-news/" rel="category tag">Featured</a>, <a href="https://www.deepdotweb.com/category/news-updates/" rel="category tag">News Updates</a></span>
    <span><a href="https://www.deepdotweb.com/2017/05/13/new-osx-malware-uses-tor-mitm-proxy/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>Years ago, many believed Apple&#8217;s OSX was immune to viruses or malware. However in 2014 and 2015, this notion changed even though Mac specific infections existed since the early 2000s. But between 2014 and 2015, reported infections more than doubled. But because of timely security updates, among other factors, MacOS or OSX still remained more secure than some alternative operating systems. The times changed as market saturation occurred. For instance, researchers at <a href="http://blog.checkpoint.com/2017/04/27/osx-malware-catching-wants-read-https-traffic/">Check Point recently discovered a new strain of malware</a> that targeted all versions OSX.</p>
    <p>Known as OSX/Dok, the malware is currently one of a kind. As of the Check Point announcement, VirusTotal is unaware of the malware—it shows zero detections. Furthermore, the malware uses an active, valid developer certificate, “and is the first major scale malware to target OSX users via a coordinated email phishing campaign.”</p>
    <p>According to <a href="https://www.documentcloud.org/documents/2459197-bit9-carbon-black-threat-research-report-2015.html">a 2015 report from Bit9 and Carbon Black</a>, Apple machines running OSX were vulnerable to a backdoor trojan called Lamadai thanks to a Java exploit; a government computer trojan called Appetite; and a Bitcoin targeting piece of malware called Coin Thief.</p>
    <p><img class="wp-image-19857 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-46.jpeg" srcset="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-46.jpeg 800w, https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-46-300x225.jpeg 300w" sizes="(max-width: 800px) 100vw, 800px" /></p>
    <p>Check Point’s most recent discovery <a href="https://www.deepdotweb.com/tag/net/">targets a user&#8217;s internet traffic</a>. But OSX/Dok is an especially malicious traffic targeting tool; a victim&#8217;s internet traffic, including SSL encrypted traffic, runs through a proxy server owned by the malware’s operator.</p>
    <p>OSX/Dok targets European users, for the most part. As of now, the main source of the malware is from phishing emails. Check Point provided an example where a German user received an email regarding inconsistencies in tax returns. The email contains a .zip file that contains the <a href="https://www.deepdotweb.com/tag/malware/">malware</a> itself. Then, if the victim executes the file, he malware copies itself to a folder and then runs shell commands.</p>
    <p>It then claims that the package is damaged via a pop-up window. After the malware’s “true installation” completes, a non-closeable window surfaces. The victim must enter his or her password into a fake security update prompt. From here on out, the attacker is effectively done with the actual infection process. The OSX admin credentials allow the malware to install brew—which it does. Through brew, <a href="https://www.deepdotweb.com/tag/tor/">the malware installs Tor</a> and SOCAT.</p>
    <p><img class="wp-image-19858 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-47.jpeg" srcset="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-47.jpeg 800w, https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-47-300x188.jpeg 300w" sizes="(max-width: 800px) 100vw, 800px" /></p>
    <p>It then downloads a Proxy Autoconfiguration file and forces all internet traffic through said proxy. A malicious root certificate installs on the machine that allows interception of all internet traffic.</p>
    <p><img class="wp-image-19859 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-48.jpeg" srcset="https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-48.jpeg 800w, https://www.deepdotweb.com/wp-content/uploads/2017/05/word-image-48-300x225.jpeg 300w" sizes="(max-width: 800px) 100vw, 800px" /></p>
    <p>Check Point researchers explained the outcome of the described installation process:</p>
    <p>“<em>As a result of all of the above actions, when attempting to surf the web, the user’s web browser will first ask the attacker web page on TOR for proxy settings. The user traffic is then redirected through a proxy controlled by the attacker, who carries out a Man-In-the-Middle attack and impersonates the various sites the user attempts to surf. The attacker is free to read the victim’s traffic and tamper with it in any way they please</em>.”</p>
    <p>When the task is complete, the malware removes itself from the victim&#8217;s machine.</p>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/malware/" rel="tag">malware</a> <a href="https://www.deepdotweb.com/tag/mitm/" rel="tag">mitm</a> <a href="https://www.deepdotweb.com/tag/osx/" rel="tag">osx</a> <a href="https://www.deepdotweb.com/tag/proxy/" rel="tag">proxy</a> <a href="https://www.deepdotweb.com/tag/tor/" rel="tag">tor</a></span> <span style="display:none" class="updated">2017-05-13</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/caliens/" title="Posts by C. Aliens" rel="author">C. Aliens</a></strong></div>
    </div>
</article>

