---
Attention &#8211; Anomalous RSA Keys In Tor Relays Can Undermine Your Privacy
---
<article class="post-listing post-19382 post type-post status-publish format-standard has-post-thumbnail hentry category-deepdot-news tag-anomalous tag-attention tag-keys tag-privacy tag-relays tag-rsa tag-tor tag-undermine">
    <div class="post-inner">
    <p class="post-meta">
    <span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
    <span>April 25, 2017</span>
    
    <span><a href="https://www.deepdotweb.com/2017/04/25/attention-anomalous-rsa-keys-tor-relays-can-undermine-privacy/#respond">Leave a comment</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>The Tor network is by far the biggest volunteer run anonymous network on the planet. Since its launch, the network has witnessed thousands of relay nodes come and go, throughout the past 10 years. To deploy the onion routing protocol, all relay nodes maintain multiple RSA keys, the most essential of which are long term keys that never changes, and medium term keys that rotate periodically.</p>
    <p><a href="https://www.deepdotweb.com/2015/06/11/how-to-host-a-tor-relay-successfully/">Relay nodes</a> with weak cryptographic keys can undermine the security and privacy of Tor users. The degree of affection of Tor users relies on the type of keys that are vulnerable. In mild affection instances, the attacker succeeds only in compromising the TLS layer keys responsible for protection of Tor cells, which are chunks of data representing the flow of traffic across the circuit formed by Tor relay nodes. In severe affection instances, the attacker successfully compromises a relay&#8217;s long term key, or the &#8220;identity key&#8221;, allowing him/her to deceivingly impersonate this relay node. Accordingly, to <a href="https://www.deepdotweb.com/2017/03/25/comprehensive-privacy-analysis-tor-hidden-services/">heighten the security of Tor users</a>, new methods are needed to quickly identify relay nodes with vulnerable keys to exclude them from the network, before they can be exploited by adversaries.</p>
    <p><img class="wp-image-19395 aligncenter" src="https://www.deepdotweb.com/wp-content/uploads/2017/04/word-image-99.png" srcset="https://www.deepdotweb.com/wp-content/uploads/2017/04/word-image-99.png 670w, https://www.deepdotweb.com/wp-content/uploads/2017/04/word-image-99-300x165.png 300w" sizes="(max-width: 670px) 100vw, 670px" /></p>
    <p><a href="https://arxiv.org/pdf/1704.00792.pdf">A group of researchers from Princeton University</a>, tried to detect vulnerable and anomalous keys, via analyzing a publicly available dataset of 3.7 million public keys of the RSA type. They searched for shared prime numbers, non-standard RSA exponents and shared moduli. Interestingly enough, they discovered around 3,000 keys with shared prime numbers, that belong to a research project that was published in 2013. Ten relay nodes in the analyzed dataset shared the same modulus, which suggests manual interference with the process that generates the RSA keys. Moreover, the researchers discovered 122 relay nodes, with RSA exponents that were different from Tor&#8217;s hard coded exponents. They concluded that the greater proportion of these relay nodes were aimed at manipulating Tor&#8217;s distributed hash table (DHT) for the purpose of attacking onion domains. Even more, they deployed a special tool that emulates how onion domains are included in the DHT, which uncovered four onion domains that were mostly targeted by attackers.</p>
    <p>The entities behind the incidents that were uncovered by the study are prominently diverse representing developers, researchers and malicious attackers who all took part in the process of generation of key anomalies. Via searching for information that relay nodes had in common, including similar IP address blocks, nicknames, port numbers and uptimes, the researchers managed to categorize the discovered relay nodes into clusters that were probably administrated by the same entities.</p>
    <p>The researchers made all their source code and obtained data publically available, to enable third parties such as The Tor Project to monitor the keys of newly formed relay nodes and notify developers whenever generated keys are found to be non-standard or vulnerable. As such, Tor developers can react early and exclude these relay nodes from the network, before malicious attackers can exploit their key vulnerabilities.</p>
    <p>Even though previous research studies analyzed the implications of vulnerable or anomalous RSA keys across various systems, this study represents the first ever study to analyze the influence of weak RSA keys on the security of Tor users. The study made two major contributions to the security of the Tor network:</p>
    <p>1. It analyzed a dataset comprised of 3.7 million public keys of the RSA type in an attempt to discover weak, anomalous and/or non-standard keys, which revealed thousands of vulnerable keys.</p>
    <p>2. It also described the features of the relay nodes discovered, showing that the greater percentage of these nodes were mostly run by a single entity, and revealing four onion domains that were mostly targeted by malicious attackers.</p>
    <p>Continuous and periodic monitoring of relay&#8217;s keys is mandatory to maximize the security of users and help early discover and exclude relays with vulnerable or anomalous keys, so similar studies are needed to be conducted in the future.</p>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/anomalous/" rel="tag">anomalous</a> <a href="https://www.deepdotweb.com/tag/attention/" rel="tag">attention</a> <a href="https://www.deepdotweb.com/tag/keys/" rel="tag">keys</a> <a href="https://www.deepdotweb.com/tag/privacy/" rel="tag">privacy</a> <a href="https://www.deepdotweb.com/tag/relays/" rel="tag">relays</a> <a href="https://www.deepdotweb.com/tag/rsa/" rel="tag">rsa</a> <a href="https://www.deepdotweb.com/tag/tor/" rel="tag">tor</a> <a href="https://www.deepdotweb.com/tag/undermine/" rel="tag">undermine</a></span> <span style="display:none" class="updated">2017-04-25</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
    </div>
</article>

