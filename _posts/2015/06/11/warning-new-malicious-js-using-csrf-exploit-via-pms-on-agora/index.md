---
title: "Warning: New Malicious JS Using CSRF exploit via PM&#8217;s On Agora"
---

10683  tag-agora tag-csrf tag-exploit tag-js tag-malicious tag-pms 

Posted by: DeepDotWeb 

<span>June 11, 2015</span>


<span><a href="/2015/06/11/warning-new-malicious-js-using-csrf-exploit-via-pms-on-agora/#comments">5 Comments</a></span>
</p>

<p>Several users of Agora Marketplace have reported receiving an message trough their PM system today, that when opened contains a malicious java script exploit that attempt to drain the Bitcoins from their wallets:</p>
<div id="attachment_10684" style="width: 723px" class="wp-caption aligncenter"><a href="/imgs/2015/06/9u7ng0q1.png"><img class="wp-image-10684 size-full" src="/imgs/2015/06/9u7ng0q1.png" alt="9u7ng0q[1]" width="713" height="350" srcset="/imgs/2015/06/9u7ng0q1.png 713w, /imgs/2015/06/9u7ng0q1-300x147.png 300w" sizes="(max-width: 713px) 100vw, 713px" /></a><p class="wp-caption-text">Thanks /u/Agoramarket for the screenshot :)</p></div>When clicked, the link attempts to execute malicious JS code using <a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> on agora in order to steal users fund from Agora&#8217;s wallet as well as changing the users PGP key and reset his PIN code. The full code of the exploit can be found <a href="http://pastebin.com/WxQyS7zA">here</a>.</p>
<div id="attachment_10692" style="width: 941px" class="wp-caption aligncenter"><a href="/imgs/2015/06/requests.png"><img class="size-full wp-image-10692" src="/imgs/2015/06/requests.png" alt="Some of the malicious requests" width="931" height="379" srcset="/imgs/2015/06/requests.png 931w, /imgs/2015/06/requests-300x122.png 300w" sizes="(max-width: 931px) 100vw, 931px" /></a><p class="wp-caption-text">Some of the malicious requests</p></div>
<div id="attachment_10695" style="width: 717px" class="wp-caption aligncenter"><a href="/imgs/2015/06/kasio.png"><img class="size-full wp-image-10695" src="/imgs/2015/06/kasio.png" alt="Another one of these messages sent from another user" width="707" height="346" srcset="/imgs/2015/06/kasio.png 707w, /imgs/2015/06/kasio-300x147.png 300w" sizes="(max-width: 707px) 100vw, 707px" /></a><p class="wp-caption-text">Another one of these messages sent from another user</p></div>
<div id="attachment_10698" style="width: 1156px" class="wp-caption aligncenter"><a href="/imgs/2015/06/syn112.png"><img class=" wp-image-10698" src="/imgs/2015/06/syn112.png" alt="Screenshot of the scammer homepage" width="1146" height="563" srcset="/imgs/2015/06/syn112.png 1701w, /imgs/2015/06/syn112-300x147.png 300w, /imgs/2015/06/syn112-1024x503.png 1024w" sizes="(max-width: 1146px) 100vw, 1146px" /></a><p class="wp-caption-text">Screenshot of the scammer homepage</p></div>
<p>In order for the exploit to work:</p>
<ul>
<li>The user has to have an active session open with Agora</li>
<li>Must have JS enabled</li>
<li>See an unknown link and be dumb enough to click on it while having have JS enabled.</li>
</ul>
<p><span style="text-decoration: underline;"><strong>Solution</strong></span>: Don&#8217;t do any of the above. Especially if you are a vendor. And hopefully that Agora will fix their CSRF vulnerability at some point (its wan known for quite a while now).</p>
<ul>
<li><a href="http://www.reddit.com/r/DarkNetMarkets/comments/39cq1e/be_careful_of_messages_on_agora_about_a_new/">Discussion thread on Reddit</a></li>
</ul>
</div>
<a href="/tag/agora/" rel="tag">agora</a> <a href="/tag/csrf/" rel="tag">csrf</a> <a href="/tag/exploit/" rel="tag">exploit</a> <a href="/tag/js/" rel="tag">js</a> <a href="/tag/malicious/" rel="tag">malicious</a> <a href="/tag/pms/" rel="tag">pms</a> <a href="/tag/warning/" rel="tag">warning</a></span> 
Updated: 2015-06-11

    
