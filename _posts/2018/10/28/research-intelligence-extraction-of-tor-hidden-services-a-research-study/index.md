---
Research: Intelligence extraction of Tor hidden services &#8211; A research study
---
<article class="post-listing post-27076 post type-post status-publish format-standard has-post-thumbnail hentry 
tag-research">
<div class="post-inner">
<span>Posted by: <a href="https://www.deepdotweb.com/author/tamersameeh/" title="">Tamer Sameeh </a></span>
<span>October 28, 2018</span>

<span><a href="https://www.deepdotweb.com/2018/10/28/research-intelligence-extraction-of-tor-hidden-services-a-research-study/#comments">3 Comments</a></span>


<p>The Tor network launched in 2002, and since then, it has been under constant development with the active release of new improvements and features. One of these essential features is the &#8220;hidden services&#8221;, which enables users to securely host their content on Tor&#8217;s network. These hidden services boast the same level of privacy and anonymity offered to clients using the Tor browser. When hidden services are considered, the name resolution concept, such as DNS, does not apply. Also, hidden services cannot be indexed by search engines such as Google, Bing, Yahoo, etc. As such, only users who have obtained the address of the hidden service via out-of-band means, are able to access the service through querying the Distributed Hash Table (DHT) for the descriptor, via the onion address.</p>
<p><a href="https://www.deepdotweb.com/2017/03/30/tor-browser-fully-anonymous-myth-reality/">Tor&#8217;s ability to offer anonymity</a> and privacy to content providers, is an essential and welcomed feature. Nonetheless, via provision of anonymity to legitimate content providers, Tor also offers means to anonymously host illegitimate services such as black markets, extremist forums, child pornography, and <a href="https://www.deepdotweb.com/2017/06/16/overview-peer-peer-p2p-botnets/">botnet C&amp;C</a>. As such, it becomes essential to safeguard legitimate content on the Tor network, while removing or blocking illegal content. This raises another concern: any process that can be used to <a href="https://www.deepdotweb.com/2017/11/16/cyber-threat-intelligence-hunting-cyber-criminals/">trace illegal content</a>, can also be used to trace the legitimate content too, which defies the basic purpose of Tor&#8217;s hidden services, as it undermines their anonymity.</p>
<p><img class="wp-image-27081 aligncenter" src="/imgs/2018/10/intelligence-extraction-png.png" alt="intelligence extraction.png" /></p>
<p><a href="http://delaat.net/rp/2017-2018/p98/report.pdf">A recently published paper</a> investigated the possibility and effectiveness of extraction of information from Tor&#8217;s hidden service. The research paper focused on the study of the Distributed Hash Table (DHT), which is used to publish the descriptors of Tor&#8217;s hidden services. A couple of servers were utilized to become part of the DHT, and thus, became responsible for the descriptors published by Tor&#8217;s hidden services.</p>
<p>The processed memory, as well as the network traffic associated with these servers were subsequently thoroughly analyzed to obtain the onion address of the Tor hidden service. This was achieved via implementation of a python framework that extracts the full descriptors of Tor&#8217;s hidden services from the process memory, and subsequently processes the independent fields in order to extract information. With only 10.54 Euros per month, the proposed python framework was executed hourly to extract Tor&#8217;s hidden services onion addresses. Throughout the process, a total of 2014 onion addresses were extracted, which proved that the vast majority of the descriptors were using the old v2 protocol, rather than the newer v3. Countermeasures including depreciation of the old protocols, or using the authentication mechanisms associated with the old protocols, were proposed to mitigate or help solve the issue.</p>
<p><strong>Approaches used in the project proposed by the research study:</strong></p>
<p>This project considered 5 possible approaches: modification of Tor software, address brute forcing, internet scraping, memory extraction, and network sniffing. Eventually, the project relied on two approaches: network sniffing and memory extraction.</p>
<p>1- Network sniffing:</p>
<p>Network sniffing is a method that is used to obtain the descriptors when they get published by the Tor hidden service, or when they get requested by the user browsing them. When the user requests a descriptor, it uses an ID derived from the hidden service onion address via a hashing mechanism. Even though it is not possible to retrieve the onion address from the ID because it has been hashed, it should be possible to visualize the response of the proxy which would include the requested descriptor. This led to the investigation of the possibility of capturing, or sniffing, the interactions taking place between the hidden services or clients on one side, and the hidden service directory server (HSDir) on the other.</p>
<p>2- Memory extraction:</p>
<p>Memory extraction is an efficient method for usage in this project, as the HSDir server needs to hold the descriptors so that the users browsing the hidden services can request them. Given the fact that it represents a security risk to write the descriptors to the file system, the application stores them in the process memory. With privileges, the process memory can be easily accessed and dumped for purpose of analysis.</p>
<p><strong>Final thoughts:</strong></p>
<p>This research study shows that it is possible to collect thousands of onion addresses via memory extraction of servers which belong to the DHT in a short time period. Moreover, it shows that this can be achieved with inexpensive resources. These findings can be utilized as a stepping stone for intelligence extraction from Tor network users.</p>
</div>
<span style="display:none"><a href="https://www.deepdotweb.com/tag/research/" rel="tag">research</a></span> <span style="display:none" class="updated">2018-10-28</span>
<div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/tamersameeh/" title="Posts by Tamer Sameeh" rel="author">Tamer Sameeh</a></strong></div>
</div>
</article>

