---
Onionshop Hacked ~ BTC Stolen (~700$)
---
<article class="post-listing post-7155 post type-post status-publish format-standard has-post-thumbnail hentry category-deepdot-news category-news-updates tag-1968 tag-btc tag-hacked tag-onionshop tag-stolen">
    <div class="post-inner">
    <p class="post-meta">
    <span>Posted by: <a href="https://www.deepdotweb.com/author/admin/" title="">DeepDotWeb </a></span>
    <span>September 21, 2014</span>
    <span>in <a href="https://www.deepdotweb.com/category/deepdot-news/" rel="category tag">Featured</a>, <a href="https://www.deepdotweb.com/category/news-updates/" rel="category tag">News Updates</a></span>
    <span><a href="https://www.deepdotweb.com/2014/09/21/onionshop-hacked-btc-stolen-700/#comments">2 Comments</a></span>
    </p>
    <div class="clear"></div>
    <div class="entry">
    <p>A formal announcement was posted on the hub forum by <a href="http://www.deepdotweb.com/marketplace-directory/listing/onionshop">Onionshop</a> admins &#8211; A services that offered vendors a simple way of running their own anonymous Bitcoin Webshop in the Tor Network, explaining that the site was taken down due to a recent hack resulted in a loss of around $700 in BTC:</p>
    <p>(http://thehub7dnl5nmcz5.onion/index.php?topic=5252.msg37668;boardseen#new)</p>
    <blockquote><p>Fellow Onionshop Community,</p>
    <p>About 2 days ago we suffered a hack of our database. The hacker replaced addresses in our BTC-Pool and managed to snatch payments for 3 orders with a total of 700$. Fortunately we had some extra security mechanisms in place that were able to prevent further damages and left most orders unaffected.</p>
    <p>After noticing that our system has been compromised, we instantly moved to a new server and changed up everything security related. We also changed our sourcecode to assign BTCs to orders directly from electrum MPKs, without storing them in a pool before. Additionally we introduced a different server where customers can doublecheck if their assigned BTC address is legit.</p>
    <p>At first, we suspected a vulnerability in our image upload script. The script checks various characteristics of files that are being uploaded and is supposed to allow only real JPG files. We noticed that somebody has managed to upload a file with a different extension shortly before the hack, so we assumed to have found the problem. The upload script was removed on the new server and planned to be replaced.</p>
    <p>Today the hacker has contacted us, stating that he still has access to our db and that the vulnerability he was exploiting is still in place. We hoped it is a weak attempt to get more BTC after losing access to our db &#8211; but he could prove us wrong and indeed, still had access. He tried to blackmail us paying 15 BTC to get info on the vulnerability. We dont see this as an option for many reasons.</p>
    <p>So here we are, searching for a needle in a 30k lines of code-haystack. Even though the hacker will have a hard time stealing any more coins with the latest changes to our BTC handling (probably the reason he offered to sell us info on the bug in the first place), he still has access to our db. and there still is a vulnerability that can enable others to get there too. The safety of our vendors, customers, and ourselves of course has always been top priority for us. Thus the only acceptable consequence for us is to take the whole site offline for an unknown amount of time. Fixing and improving various parts of the code and relaunching in a few days would work, but doesnt meet the high demands we have towards our OPSEC. In order to reopen, we have to inspect our whole code, rewrite fundamental parts of it and do a lot of security and penetration testing.</p>
    <p>As of today, we are not sure yet on which path we will take from here exactly. We will need some time evaluating everything before we can announce a plan on how we move forward. Most likely we will develop a new version of Onionshop, preferably OpenBazaar-based, if this should become an option soon. We will keep running this domain and keep you updated here.</p>
    <p>Every order that has been placed will be shipped regularly. We leave the vendors area accessible so that any unfinished business can be taken care of: onionshopkue7sxr.onion/vendorlogin</p>
    <p>If you are a customer, please contact your vendor through another market, the Hub, or any other form of communication they provide. Below this text we provide a link to a list of our vendors and where to contact them. If you need something from your User-area which cannot be provided by the vendor, please contact us directly on the Hub (thehub7dnl5nmcz5.onion, username Onionshop) and we will look into it for you.</p>
    <p>Unlike 6 months ago when we launched Onionshop, there is a wide range of good and promising marketplaces nowadays where you can go to alternatively. Check out the marketlist of Deepdotweb.com for example. From our own experience, we recommend using Evolution (http://k5zq47j6wd3wdvjq.onion) or Cloud9 (http://bviaqyj6obc54vhn.onion). We are not related to them, nor do we vouch for them, just a good feeling there. Be careful if you use traditional escrow, only deposit funds you need for a purchase. Vendors should withdraw everything immediately after having orders finalized.</p>
    <p>We are sorry to put everybody through this hassle, but we hope the majority will agree with us, that in consideration of the situation, this is the only way to go. We thank all our loyal vendors and customers for putting trust in us and choosing Onionshop to roll with.</p>
    <p>Special shout-out goes to the people we have been working with, especially our 2 developers and our graphic designer. Please contact us through the hub!</p>
    <p>Rest assured, we will not disappear, nor do we break any agreement we have made. We stay right where we are and will do anything possible to support our userbase through these tumultuous times. There wont be another sheep on our watch,</p>
    <p>Take Care,</p>
    <p>Onionshop</p></blockquote>
    <p><a href="/imgs/2014/09/onionhacked.png"><img class="aligncenter  wp-image-7156" src="https://www.deepdotweb.com/wp-content/uploads/2014/09/onionhacked.png" alt="onionhacked" width="642" height="353" srcset="https://www.deepdotweb.com/wp-content/uploads/2014/09/onionhacked.png 978w, https://www.deepdotweb.com/wp-content/uploads/2014/09/onionhacked-300x165.png 300w" sizes="(max-width: 642px) 100vw, 642px"/></a></p>
    <p>This announcement was later followed by a post made by the hacker himself on <a href="http://www.reddit.com/r/DarkNetMarkets/comments/2gyefs/onionshop_hacked_all_bitcoins_stolen_and_im_still/" target="_blank">Reddit</a> (seems to be confirmed as the hacker):</p>
    <div class="usertext-body may-blank-within">
    <div class="md">
    <blockquote><p><strong>Onionshop Hacked, all Bitcoins stolen (And I&#8217;m still in the db&#8230; )</strong></p>
    <p>http://thehub7dnl5nmcz5.onion/index.php?topic=5252.msg37668;boardseen#new</p>
    <p>I used a simple MySQL injection on the image upload page and gained access to his entire database. From there, it was a simple replace of all his Bitcoin addresses with my own ones. It took this idiot all of 4 days to realize what has happened, but STILL he hasn&#8217;t fixed the vulnerability. I&#8217;m in the database as we speak, this is a shear level of incompetence I cannot even comprehend. He&#8217;s now put all his original addresses back on the list, but I&#8217;m replacing them again since he hasn&#8217;t locked me out. Holy fucking shit.</p>
    <p>He can see me changing shit in the database but his excuse of why he hasn&#8217;t fixed this yet is &#8220;there is 30k lines of code and it is like trying to find a needle in a haystack.&#8221; Jesus fucking christ, I even messaged him telling him how I gained access. He has now sent me a begging PM asking me not to expose his incompetence and to &#8220;kindly sent the funds back to me and I will remember your good deed, I know you are a good person deep down please do the right thing and give back what you took&#8221;</p>
    <p>Sorry. But this a seriously, seriously incompetent admin and I hope anyone reading this will stay clear of any future revisions of Onionshop unless you want to get royally sodomized courtesy of this fool. If I took your money and you can prove it&#8217;s yours by sending me your ID for the order, and your address, I will refund you. I ask that you take your refund and use it anywhere else but NOT Onionshop. I am extremely surprised that no one exploited this vulnerability before me, it took all of 30 minutes to construct the tables, display and then update the rows from a completely unsanitized input.</p>
    <p>I have the database and can dump tables to prove my claims, (unless it&#8217;s against <a href="http://www.reddit.com/r/DNM">/r/DNM</a> policy). Passwords are all md5 so something was done right at least.</p>
    <p><strong>DON&#8217;T USE ONIONSHOP. IF YOU DO, GOD HELP YOU.</strong></p>
    <hr/>
    <p><strong>UPDATE: <a href="http://s2.postimg.org/7kskh5v1l/oss2.png" target="_blank">http://s2.postimg.org/7kskh5v1l/oss2.png</a>.</strong><strong>My work here is done. Take this as a wake up call, Onionshop&#8230;<br/>
    </strong> <a href="/imgs/2014/09/dnm.png"><img class="aligncenter size-full wp-image-7160" src="https://www.deepdotweb.com/wp-content/uploads/2014/09/dnm.png" alt="dnm" width="982" height="542" srcset="https://www.deepdotweb.com/wp-content/uploads/2014/09/dnm.png 982w, https://www.deepdotweb.com/wp-content/uploads/2014/09/dnm-300x166.png 300w" sizes="(max-width: 982px) 100vw, 982px"/></a></p></blockquote>
    <p>Seems that Onionshop admins did the right thing taking the site offline until this have been investigated and the exploit fixed. Luckily In this case the financial lost was not much.</p>
    </div>
    </div>
    </div>
    <span style="display:none"><a href="https://www.deepdotweb.com/tag/700/" rel="tag">700</a> <a href="https://www.deepdotweb.com/tag/btc/" rel="tag">btc</a> <a href="https://www.deepdotweb.com/tag/hacked/" rel="tag">hacked</a> <a href="https://www.deepdotweb.com/tag/onionshop/" rel="tag">onionshop</a> <a href="https://www.deepdotweb.com/tag/stolen/" rel="tag">stolen</a></span> <span style="display:none" class="updated">2014-09-21</span>
    <div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://www.deepdotweb.com/author/admin/" title="Posts by DeepDotWeb" rel="author">DeepDotWeb</a></strong></div>
    </div>
</article>

